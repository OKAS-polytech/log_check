# テスト仕様書および結果報告

## 1. テスト概要
本テストでは、リファクタリング後のアプリケーションが要件を満たし、検索ロジックが正しく機能していることを検証する。主に単体テスト（アルゴリズムの正当性）および結合テスト（ファイルの読み込みから検索、結果表示まで）を実施した。

## 2. テスト項目と結果

### 2.1 アルゴリズム正当性テスト
各アルゴリズムが、与えられたテキストから正しくキーワードを検出できるかを確認。

| ID | テスト項目 | 期待される結果 | 結果 | 備考 |
|:---|:---|:---|:---:|:---|
| T1-1 | Naive Search | 指定位置のキーワードを全て検出 | 合格 | |
| T1-2 | Boyer-Moore | 指定位置のキーワードを全て検出 | 合格 | |
| T1-3 | KMP | 指定位置のキーワードを全て検出 | 合格 | |
| T1-4 | Aho-Corasick | 複数キーワードを一度の走査で検出 | 合格 | |
| T1-5 | Bitap (d=0) | 完全一致するキーワードを検出 | 合格 | |
| T1-6 | Bitap (d=2) | 2文字以内の差異がある単語を検出 | 合格 | |

### 2.2 ファイル入出力テスト
| ID | テスト項目 | 期待される結果 | 結果 | 備考 |
|:---|:---|:---|:---:|:---|
| T2-1 | .txt ファイル読み込み | 正常にテキストを抽出して検索可能 | 合格 | |
| T2-2 | .docx ファイル読み込み | 段落テキストを抽出して検索可能 | 合格 | |
| T2-3 | ストリーミング読み込み | 50MB超のファイルでもメモリ不足にならず完了 | 合格 | |
| T2-4 | CSV/Excel 出力 | 検索結果が正しい形式で保存される | 合格 | |

### 2.3 UI/UX および推定機能テスト
| ID | テスト項目 | 期待される結果 | 結果 | 備考 |
|:---|:---|:---|:---:|:---|
| T3-1 | ベンチマーク実行 | 起動時に計測が行われ、係数が更新される | 合格 | |
| T3-2 | 推定時間表示 | キーワードやファイルに応じて時間が変動する | 合格 | |
| T3-3 | D&D 機能 | ファイルをドロップしてパスが取得される | 合格 | |

## 3. テスト結果のレビュー
リファクタリング後の検証において、以下の点を確認した：

1. **検索ロジックの安定性**: 旧コードからの移行にあたり、Bitap アルゴリズムの不具合（インデックス計算の誤り）を特定し、修正した。これにより、すべての探索手法で一貫した結果が得られるようになった。
2. **パフォーマンス**: 50MBを超えるダミーデータを用いたテストにより、ストリーミング検索が正しく機能することを確認した。これにより、メモリ使用量を一定に保ったまま大規模なログファイル等の検索が可能となっている。
3. **アーキテクチャの有効性**: テストスクリプト（`test_refactor_v2.py` 等）を用いて、UIを介さずにビジネスロジックのみを独立してテストできることを確認した。これはクリーンアーキテクチャ導入による大きな成果である。

## 4. 課題と今後の展望
- **バイナリファイルの対応**: 現在はテキストベースの検索が主であるが、PDF 等のより複雑なフォーマットへの対応を Infrastructure レイヤーに追加することで、容易に拡張可能である。
- **並列処理**: 現在の検索はファイルごとに逐次実行されているが、マルチプロセス化することでさらなる高速化が期待できる。
