# アプリケーション使用手順書

本アプリケーション（String Search App）のセットアップおよび使用方法について説明する。

## 1. 動作環境
- **OS**: Windows / macOS / Linux (GUI環境が必要)
- **Python**: 3.8 以上
- **必要なライブラリ**:
  - `ttkbootstrap` (UIテーマ)
  - `tkinterdnd2-universal` (ドラッグ＆ドロップ機能)
  - `openpyxl` (Excel出力)
  - `python-docx` (Wordファイル読み込み)
  - `chardet` (文字コード自動判別)
  - `Pillow` (画像処理/スクリーンショット用)

## 2. インストール手順
以下のコマンドを実行して、必要な依存ライブラリをインストールしてください。

```bash
pip install ttkbootstrap tkinterdnd2-universal openpyxl python-docx chardet Pillow
```

## 3. 起動方法
リポジトリのルートディレクトリから、以下のコマンドを実行してください。

```bash
python programs/main.py
```

## 4. 使用手順

### ステップ 1: ファイルの選択
- 画面上部の「ここにファイルをドラッグ＆ドロップ」エリアに、検索対象としたいファイルをドロップします。
- ドロップすると、ファイル数と合計サイズが表示されます。

### ステップ 2: 検索アルゴリズムの選択
- 5種類の中から使用したいアルゴリズムを選択します。
- あいまい検索を行いたい場合は「Bitap (Fuzzy!)」を選択し、許容する「レーベンシュタイン距離」を入力してください。

### ステップ 3: 検索キーワードの設定
- テキストボックスに検索したいワードを入力します。
- 「検索ワード追加」ボタンで入力欄を増やせます。
- 多数のワードがある場合は「検索ワードを CSV から読み込み」ボタンを使用してください。

### ステップ 4: 検索の実行
- 「検索実行」ボタンを押すと検索が開始されます。
- 検索中は UI が応答しなくなる場合がありますが、完了すると自動的に「RESULT」ウィンドウが開きます。

### ステップ 5: 結果の確認と保存
- 結果画面では、どのファイルのどの位置にキーワードが出現したかを確認できます。
- 必要に応じて「CSV」または「Excel」ボタンを押し、結果をファイルとして保存してください。

## 5. 注意事項
- **大容量ファイル**: 50MBを超えるファイルは自動的に分割して読み込まれます。
- **文字コード**: UTF-8 を推奨しますが、一般的なテキストファイルであれば自動的に読み込みを試みます。
- **Bitap の制限**: Bitap によるあいまい検索は現在ストリーミング読み込みに対応していないため、極めて大きなファイルの検索には向きません。
- **バイナリファイル**: バイナリファイルを読み込む際は、自動的に文字コードを判別し、失敗した場合は `latin-1` として全バイトを読み込みます。これによりバイナリデータ内の文字列探索が可能です。
